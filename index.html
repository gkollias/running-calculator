<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Running Calculator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .calculators-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .calculator-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .calculator-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.25);
        }

        .calculator-card h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.5rem;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
        }

        .input-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #555;
        }

        input[type="number"],
        input[type="text"],
        select {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        input[type="number"]:focus,
        input[type="text"]:focus,
        select:focus {
            outline: none;
            border-color: #667eea;
        }

        .input-row {
            display: flex;
            gap: 10px;
        }

        .input-row .input-group {
            flex: 1;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            width: 100%;
            margin-top: 10px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        .result {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }

        .result h3 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .result-item {
            margin-bottom: 8px;
            font-size: 15px;
        }

        .result-item strong {
            color: #333;
        }

        .unit-toggle {
            display: flex;
            justify-content: center;
            margin-bottom: 15px;
            gap: 10px;
        }

        .unit-toggle button {
            width: auto;
            padding: 8px 20px;
            margin: 0;
            background: #e0e0e0;
            color: #333;
        }

        .unit-toggle button.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .pace-splits {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }

        .pace-split {
            background: white;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #e0e0e0;
        }

        .pace-split-distance {
            font-size: 14px;
            color: #666;
            margin-bottom: 5px;
        }

        .pace-split-time {
            font-size: 18px;
            font-weight: 600;
            color: #667eea;
        }

        @media (max-width: 768px) {
            .calculators-grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèÉ‚Äç‚ôÇÔ∏è Advanced Running Calculator</h1>
            <p>Calculate VDOT, pace, splits, and optimize your training</p>
        </div>

        <div class="calculators-grid">
            <!-- VDOT Calculator -->
            <div class="calculator-card">
                <h2>VDOT Calculator</h2>
                <div class="input-group">
                    <label for="vdot-distance">Race Distance</label>
                    <select id="vdot-distance">
                        <option value="1500">1500m</option>
                        <option value="1609.344">1 Mile</option>
                        <option value="3000">3000m</option>
                        <option value="5000" selected>5K</option>
                        <option value="10000">10K</option>
                        <option value="21097.5">Half Marathon</option>
                        <option value="42195">Marathon</option>
                    </select>
                </div>
                <div class="input-row">
                    <div class="input-group">
                        <label for="vdot-minutes">Minutes</label>
                        <input type="number" id="vdot-minutes" min="0" value="20">
                    </div>
                    <div class="input-group">
                        <label for="vdot-seconds">Seconds</label>
                        <input type="number" id="vdot-seconds" min="0" max="59" value="0">
                    </div>
                </div>
                <button onclick="calculateVDOT()">Calculate VDOT</button>
                <div id="vdot-result" class="result" style="display: none;"></div>
            </div>

            <!-- Pace Calculator -->
            <div class="calculator-card">
                <h2>Pace Calculator</h2>
                <div class="unit-toggle">
                    <button class="active" onclick="togglePaceUnit('km')">Kilometers</button>
                    <button onclick="togglePaceUnit('mi')">Miles</button>
                </div>
                <div class="input-group">
                    <label for="pace-distance">Distance (<span id="pace-unit">km</span>)</label>
                    <input type="number" id="pace-distance" step="0.1" value="10">
                </div>
                <div class="input-row">
                    <div class="input-group">
                        <label for="pace-hours">Hours</label>
                        <input type="number" id="pace-hours" min="0" value="0">
                    </div>
                    <div class="input-group">
                        <label for="pace-minutes">Minutes</label>
                        <input type="number" id="pace-minutes" min="0" value="45">
                    </div>
                    <div class="input-group">
                        <label for="pace-seconds">Seconds</label>
                        <input type="number" id="pace-seconds" min="0" max="59" value="0">
                    </div>
                </div>
                <button onclick="calculatePace()">Calculate Pace</button>
                <div id="pace-result" class="result" style="display: none;"></div>
            </div>

            <!-- Split Calculator -->
            <div class="calculator-card">
                <h2>Split Calculator</h2>
                <div class="input-group">
                    <label for="split-pace-min">Target Pace (min/km)</label>
                    <div class="input-row">
                        <input type="number" id="split-pace-min" placeholder="Min" min="0" value="5">
                        <input type="number" id="split-pace-sec" placeholder="Sec" min="0" max="59" value="0">
                    </div>
                </div>
                <div class="input-group">
                    <label for="split-distance">Race Distance</label>
                    <select id="split-distance">
                        <option value="5">5K</option>
                        <option value="10" selected>10K</option>
                        <option value="21.0975">Half Marathon</option>
                        <option value="42.195">Marathon</option>
                    </select>
                </div>
                <button onclick="calculateSplits()">Calculate Splits</button>
                <div id="split-result" class="result" style="display: none;"></div>
            </div>

            <!-- Training Zones Calculator -->
            <div class="calculator-card">
                <h2>Heart Rate Training Zones</h2>
                <div class="input-group">
                    <label for="max-hr">Maximum Heart Rate</label>
                    <input type="number" id="max-hr" placeholder="Enter max HR or age" value="180">
                </div>
                <div class="input-group">
                    <label for="rest-hr">Resting Heart Rate (optional)</label>
                    <input type="number" id="rest-hr" placeholder="Optional for Karvonen method" value="">
                </div>
                <button onclick="calculateHRZones()">Calculate Zones</button>
                <div id="hr-result" class="result" style="display: none;"></div>
            </div>

            <!-- Race Predictor -->
            <div class="calculator-card">
                <h2>Race Time Predictor</h2>
                <div class="input-group">
                    <label for="known-distance">Known Race Distance</label>
                    <select id="known-distance">
                        <option value="5000">5K</option>
                        <option value="10000" selected>10K</option>
                        <option value="21097.5">Half Marathon</option>
                        <option value="42195">Marathon</option>
                    </select>
                </div>
                <div class="input-row">
                    <div class="input-group">
                        <label for="known-hours">Hours</label>
                        <input type="number" id="known-hours" min="0" value="0">
                    </div>
                    <div class="input-group">
                        <label for="known-minutes">Minutes</label>
                        <input type="number" id="known-minutes" min="0" value="45">
                    </div>
                    <div class="input-group">
                        <label for="known-seconds">Seconds</label>
                        <input type="number" id="known-seconds" min="0" max="59" value="0">
                    </div>
                </div>
                <button onclick="predictRaceTimes()">Predict Times</button>
                <div id="predict-result" class="result" style="display: none;"></div>
            </div>

            <!-- Calorie Calculator -->
            <div class="calculator-card">
                <h2>Running Calorie Calculator</h2>
                <div class="input-group">
                    <label for="weight">Weight (kg)</label>
                    <input type="number" id="weight" step="0.1" value="70">
                </div>
                <div class="input-group">
                    <label for="cal-distance">Distance (km)</label>
                    <input type="number" id="cal-distance" step="0.1" value="10">
                </div>
                <div class="input-group">
                    <label for="cal-time">Time (minutes)</label>
                    <input type="number" id="cal-time" value="50">
                </div>
                <button onclick="calculateCalories()">Calculate Calories</button>
                <div id="calorie-result" class="result" style="display: none;"></div>
            </div>
        </div>
    </div>

    <script>
        // VDOT calculation based on Jack Daniels' formula
        function calculateVDOT() {
            const distance = parseFloat(document.getElementById('vdot-distance').value);
            const minutes = parseInt(document.getElementById('vdot-minutes').value);
            const seconds = parseInt(document.getElementById('vdot-seconds').value);
            
            const totalMinutes = minutes + seconds / 60;
            
            // Use the reverse-engineered VDOT formula
            // This is based on the relationship: VO2 = -4.60 + 0.182258 * velocity + 0.000104 * velocity^2
            // And % VO2max = 0.8 + 0.1894393 * e^(-0.012778 * t) + 0.2989558 * e^(-0.1932605 * t)
            
            const velocity = (distance / 1000) / (totalMinutes / 60); // km/h
            const velocityMeterPerMin = distance / totalMinutes; // meters per minute
            
            // Calculate oxygen demand
            const vo2 = -4.60 + 0.182258 * velocityMeterPerMin + 0.000104 * velocityMeterPerMin * velocityMeterPerMin;
            
            // Calculate fraction of VO2max
            const percentMax = 0.8 + 0.1894393 * Math.exp(-0.012778 * totalMinutes) + 0.2989558 * Math.exp(-0.1932605 * totalMinutes);
            
            // Calculate VDOT
            const vdot = vo2 / percentMax;
            
            // Calculate training paces based on VDOT
            const easyPace = calculatePaceFromVDOT(vdot, 0.59, 0.74);
            const marathonPace = calculatePaceFromVDOT(vdot, 0.75, 0.84);
            const thresholdPace = calculatePaceFromVDOT(vdot, 0.83, 0.88);
            const intervalPace = calculatePaceFromVDOT(vdot, 0.95, 0.98);
            const repetitionPace = calculatePaceFromVDOT(vdot, 1.05, 1.20);
            
            let resultHTML = `
                <h3>Your VDOT: ${vdot.toFixed(1)}</h3>
                <div class="result-item"><strong>Easy Pace:</strong> ${formatPace(easyPace.min)} - ${formatPace(easyPace.max)} per km</div>
                <div class="result-item"><strong>Marathon Pace:</strong> ${formatPace(marathonPace.min)} - ${formatPace(marathonPace.max)} per km</div>
                <div class="result-item"><strong>Threshold Pace:</strong> ${formatPace(thresholdPace.min)} - ${formatPace(thresholdPace.max)} per km</div>
                <div class="result-item"><strong>Interval Pace:</strong> ${formatPace(intervalPace.min)} - ${formatPace(intervalPace.max)} per km</div>
                <div class="result-item"><strong>Repetition Pace:</strong> ${formatPace(repetitionPace.min)} - ${formatPace(repetitionPace.max)} per km</div>
            `;
            
            document.getElementById('vdot-result').innerHTML = resultHTML;
            document.getElementById('vdot-result').style.display = 'block';
        }
        
        function calculatePaceFromVDOT(vdot, minPercent, maxPercent) {
            // Convert VDOT percentage to velocity (meters per minute)
            // Using the inverse of the VO2 formula
            const minVO2 = vdot * minPercent;
            const maxVO2 = vdot * maxPercent;
            
            // Solve for velocity: VO2 = -4.60 + 0.182258 * v + 0.000104 * v^2
            // Using quadratic formula
            function velocityFromVO2(vo2) {
                const a = 0.000104;
                const b = 0.182258;
                const c = -4.60 - vo2;
                
                const velocity = (-b + Math.sqrt(b * b - 4 * a * c)) / (2 * a);
                return velocity; // meters per minute
            }
            
            const minVelocity = velocityFromVO2(minVO2);
            const maxVelocity = velocityFromVO2(maxVO2);
            
            // Convert to seconds per km
            return {
                min: (1000 / maxVelocity) * 60, // seconds per km
                max: (1000 / minVelocity) * 60
            };
        }
        
        function formatPace(secondsPerKm) {
            const minutes = Math.floor(secondsPerKm / 60);
            const seconds = Math.round(secondsPerKm % 60);
            return `${minutes}:${seconds.toString().padStart(2, '0')}`;
        }
        
        // Pace Calculator
        let paceUnit = 'km';
        
        function togglePaceUnit(unit) {
            paceUnit = unit;
            document.getElementById('pace-unit').textContent = unit;
            document.querySelectorAll('.unit-toggle button').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
        }
        
        function calculatePace() {
            const distance = parseFloat(document.getElementById('pace-distance').value);
            const hours = parseInt(document.getElementById('pace-hours').value) || 0;
            const minutes = parseInt(document.getElementById('pace-minutes').value) || 0;
            const seconds = parseInt(document.getElementById('pace-seconds').value) || 0;
            
            const totalSeconds = hours * 3600 + minutes * 60 + seconds;
            const paceSeconds = totalSeconds / distance;
            
            const paceMinutes = Math.floor(paceSeconds / 60);
            const paceSecondsRemainder = Math.round(paceSeconds % 60);
            
            // Calculate speed
            const speedKmh = (distance / totalSeconds) * 3600;
            const speedMph = speedKmh * 0.621371;
            
            let resultHTML = `
                <h3>Pace Analysis</h3>
                <div class="result-item"><strong>Pace:</strong> ${paceMinutes}:${paceSecondsRemainder.toString().padStart(2, '0')} per ${paceUnit}</div>
                <div class="result-item"><strong>Speed:</strong> ${speedKmh.toFixed(2)} km/h (${speedMph.toFixed(2)} mph)</div>
            `;
            
            // If km, also show mile pace
            if (paceUnit === 'km') {
                const milePaceSeconds = paceSeconds * 1.60934;
                const milePaceMinutes = Math.floor(milePaceSeconds / 60);
                const milePaceSecondsRemainder = Math.round(milePaceSeconds % 60);
                resultHTML += `<div class="result-item"><strong>Mile Pace:</strong> ${milePaceMinutes}:${milePaceSecondsRemainder.toString().padStart(2, '0')} per mile</div>`;
            } else {
                const kmPaceSeconds = paceSeconds / 1.60934;
                const kmPaceMinutes = Math.floor(kmPaceSeconds / 60);
                const kmPaceSecondsRemainder = Math.round(kmPaceSeconds % 60);
                resultHTML += `<div class="result-item"><strong>Kilometer Pace:</strong> ${kmPaceMinutes}:${kmPaceSecondsRemainder.toString().padStart(2, '0')} per km</div>`;
            }
            
            document.getElementById('pace-result').innerHTML = resultHTML;
            document.getElementById('pace-result').style.display = 'block';
        }
        
        // Split Calculator
        function calculateSplits() {
            const paceMin = parseInt(document.getElementById('split-pace-min').value);
            const paceSec = parseInt(document.getElementById('split-pace-sec').value);
            const distance = parseFloat(document.getElementById('split-distance').value);
            
            const paceSeconds = paceMin * 60 + paceSec;
            
            let resultHTML = '<h3>Race Splits</h3><div class="pace-splits">';
            
            // Calculate splits for various distances
            const splitDistances = [1, 5, 10, 15, 20, 21.0975, 25, 30, 35, 40, 42.195];
            
            splitDistances.forEach(splitDist => {
                if (splitDist <= distance) {
                    const splitTime = splitDist * paceSeconds;
                    const hours = Math.floor(splitTime / 3600);
                    const minutes = Math.floor((splitTime % 3600) / 60);
                    const seconds = Math.round(splitTime % 60);
                    
                    let timeStr = '';
                    if (hours > 0) {
                        timeStr = `${hours}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                    } else {
                        timeStr = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                    }
                    
                    resultHTML += `
                        <div class="pace-split">
                            <div class="pace-split-distance">${splitDist}km</div>
                            <div class="pace-split-time">${timeStr}</div>
                        </div>
                    `;
                }
            });
            
            resultHTML += '</div>';
            
            // Add total time
            const totalTime = distance * paceSeconds;
            const totalHours = Math.floor(totalTime / 3600);
            const totalMinutes = Math.floor((totalTime % 3600) / 60);
            const totalSeconds = Math.round(totalTime % 60);
            
            let totalTimeStr = '';
            if (totalHours > 0) {
                totalTimeStr = `${totalHours}:${totalMinutes.toString().padStart(2, '0')}:${totalSeconds.toString().padStart(2, '0')}`;
            } else {
                totalTimeStr = `${totalMinutes}:${totalSeconds.toString().padStart(2, '0')}`;
            }
            
            resultHTML += `<div class="result-item" style="margin-top: 15px;"><strong>Total Time:</strong> ${totalTimeStr}</div>`;
            
            document.getElementById('split-result').innerHTML = resultHTML;
            document.getElementById('split-result').style.display = 'block';
        }
        
        // Heart Rate Zones Calculator
        function calculateHRZones() {
            const maxHR = parseInt(document.getElementById('max-hr').value);
            const restHR = parseInt(document.getElementById('rest-hr').value) || 0;
            
            let resultHTML = '<h3>Training Zones</h3>';
            
            const zones = [
                { name: 'Zone 1 - Easy', min: 0.5, max: 0.6, description: 'Recovery, warm-up' },
                { name: 'Zone 2 - Aerobic', min: 0.6, max: 0.7, description: 'Base building' },
                { name: 'Zone 3 - Tempo', min: 0.7, max: 0.8, description: 'Marathon pace' },
                { name: 'Zone 4 - Threshold', min: 0.8, max: 0.9, description: 'Lactate threshold' },
                { name: 'Zone 5 - VO2 Max', min: 0.9, max: 1.0, description: 'Maximum effort' }
            ];
            
            zones.forEach(zone => {
                let minHR, maxHR_zone;
                
                if (restHR > 0) {
                    // Karvonen method
                    const hrReserve = maxHR - restHR;
                    minHR = Math.round(restHR + (hrReserve * zone.min));
                    maxHR_zone = Math.round(restHR + (hrReserve * zone.max));
                } else {
                    // Simple percentage method
                    minHR = Math.round(maxHR * zone.min);
                    maxHR_zone = Math.round(maxHR * zone.max);
                }
                
                resultHTML += `
                    <div class="result-item">
                        <strong>${zone.name}:</strong> ${minHR} - ${maxHR_zone} bpm
                        <br><small style="color: #666;">${zone.description}</small>
                    </div>
                `;
            });
            
            document.getElementById('hr-result').innerHTML = resultHTML;
            document.getElementById('hr-result').style.display = 'block';
        }
        
        // Race Predictor
        function predictRaceTimes() {
            const knownDistance = parseFloat(document.getElementById('known-distance').value);
            const hours = parseInt(document.getElementById('known-hours').value) || 0;
            const minutes = parseInt(document.getElementById('known-minutes').value) || 0;
            const seconds = parseInt(document.getElementById('known-seconds').value) || 0;
            
            const knownTime = hours * 3600 + minutes * 60 + seconds;
            
            // Riegel's formula: T2 = T1 * (D2/D1)^1.06
            const distances = [
                { name: '5K', meters: 5000 },
                { name: '10K', meters: 10000 },
                { name: 'Half Marathon', meters: 21097.5 },
                { name: 'Marathon', meters: 42195 }
            ];
            
            let resultHTML = '<h3>Predicted Race Times</h3>';
            
            distances.forEach(race => {
                if (race.meters !== knownDistance) {
                    const predictedTime = knownTime * Math.pow(race.meters / knownDistance, 1.06);
                    const predHours = Math.floor(predictedTime / 3600);
                    const predMinutes = Math.floor((predictedTime % 3600) / 60);
                    const predSeconds = Math.round(predictedTime % 60);
                    
                    let timeStr = '';
                    if (predHours > 0) {
                        timeStr = `${predHours}:${predMinutes.toString().padStart(2, '0')}:${predSeconds.toString().padStart(2, '0')}`;
                    } else {
                        timeStr = `${predMinutes}:${predSeconds.toString().padStart(2, '0')}`;
                    }
                    
                    resultHTML += `<div class="result-item"><strong>${race.name}:</strong> ${timeStr}</div>`;
                }
            });
            
            document.getElementById('predict-result').innerHTML = resultHTML;
            document.getElementById('predict-result').style.display = 'block';
        }
        
        // Calorie Calculator
        function calculateCalories() {
            const weight = parseFloat(document.getElementById('weight').value);
            const distance = parseFloat(document.getElementById('cal-distance').value);
            const time = parseInt(document.getElementById('cal-time').value);
            
            // Calculate speed and MET value
            const speedKmh = (distance / time) * 60;
            let met;
            
            // MET values based on running speed
            if (speedKmh < 6.4) met = 6.0;
            else if (speedKmh < 8.0) met = 8.3;
            else if (speedKmh < 9.7) met = 9.8;
            else if (speedKmh < 11.3) met = 11.0;
            else if (speedKmh < 12.9) met = 12.8;
            else if (speedKmh < 14.5) met = 14.5;
            else if (speedKmh < 16.1) met = 16.0;
            else met = 19.0;
            
            // Calculate calories: MET * weight * time(hours)
            const calories = met * weight * (time / 60);
            
            // Simple formula: ~1 calorie per kg per km
            const simpleCalories = weight * distance;
            
            let resultHTML = `
                <h3>Calorie Burn Estimate</h3>
                <div class="result-item"><strong>Speed:</strong> ${speedKmh.toFixed(1)} km/h</div>
                <div class="result-item"><strong>MET-based estimate:</strong> ${Math.round(calories)} calories</div>
                <div class="result-item"><strong>Simple estimate:</strong> ${Math.round(simpleCalories)} calories</div>
                <div class="result-item"><strong>Average:</strong> ${Math.round((calories + simpleCalories) / 2)} calories</div>
            `;
            
            document.getElementById('calorie-result').innerHTML = resultHTML;
            document.getElementById('calorie-result').style.display = 'block';
        }
    </script>
</body>
</html>